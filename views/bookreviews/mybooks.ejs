<link rel="stylesheet" href="/stylesheets/mybooks.css">

<!-- Header -->
<header class="mybook-header">My Book Reviews</header>

<!-- Search Form -->
<form class="search-form" method="GET" action="/mybooks/search">
    <input type="text" name="query" placeholder="Search by book title or author" class="search-input">
    <button type="submit" class="btn btn-primary">Search</button>
</form>

<!-- Content Container -->
<div class="review-container mb-3">
    <% if (reviews.length > 0) { %>
        <% reviews.forEach(review => { %>
            <div class="review-card">
                <!-- Book Image -->
                <img src="<%= review.book.image %>" alt="Book Image" class="book-image">

                <!-- Review Content -->
                <div class="review-content">
                    <h3><%= review.book.title %></h3>
                    <p><%= review.book.author %></p>
                    <p><strong>Rating:</strong> <%= review.rating %>/5 ‚≠ê</p>
                    <p class="review-body"><strong>Review:</strong> <%= review.body.replace(/\n/g, '<br>') %></p>
                    <button class="toggle-button">Read More</button>
                    <p class="review-date">Reviewed on: <%= review.createdAt.toLocaleDateString() %></p>

                    <!-- ÏàòÏ†ï Î∞è ÏÇ≠Ï†ú Î≤ÑÌäº -->
                    <% if (currentUser && review.author.equals(currentUser._id)) { %>
                        <div class="mt-3">
                            <!-- ÏôºÏ™Ω: ÏàòÏ†ï Î∞è ÏÇ≠Ï†ú Î≤ÑÌäº -->
                            <div class="action-buttons">
                                <!-- ÏàòÏ†ï Î≤ÑÌäº -->
                                <a href="/books/<%= review.book._id%>/reviews/<%= review._id %>/edit" class="btn btn-sm btn-outline-warning me-2">Edit</a>
                                <!-- ÏÇ≠Ï†ú Î≤ÑÌäº -->
                                <form action="/books/<%= review.book._id%>/reviews/<%= review._id %>?_method=DELETE" method="POST" class="d-inline">
                                    <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                                </form>
                                <!-- Ïò§Î•∏Ï™Ω: Ï±Ö Î≥¥Í∏∞ Î≤ÑÌäº -->
                            <a href="/books/<%= review.book._id %>" class="btn btn-sm btn-primary">View Book Details</a>
                            </div> 
                        </div>
                    <% } %>
                </div>
            </div>
        <% }); %>
    <% } else { %>
        <div class="empty">You haven't written any reviews yet. Start reviewing books now! üìö</div>
    <% } %>
</div>

<script src="/javascripts/reviewtoggle.js"></script>